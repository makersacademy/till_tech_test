var async = require('async');
var chai = require("chai");
var chaiAsPromised = require("chai-as-promised");
chai.use(chaiAsPromised);
chai.should();

var client = require('./index').remote({
    logLevel: 'silent',
    desiredCapabilities: {
        browserName: 'firefox'
    }
});
chaiAsPromised.transferPromiseness = client.transferPromiseness;

// // client
// //     .init()
// //     .url('http://webdriverjs.christian-bromann.com/')
// //     .getTitle(function(err, title) {
// //         console.log('im testscript',title);
// //     })
// //     .end();

// describe('test', function() {

//     before(function() {
//         return client.init().url('http://webdriverjs.christian-bromann.com/');
//     });

//     it('testaA', function() {
//         return client.getTitle().should.become('WebdriverJS Testpage')
//                      .isVisible('body').should.eventually.be.true;
//     });

//     after(function() {
//         return client.end();
//     });

// });

describe('test', function() {

    var elem;

    before(function(done) {
        client
            .init()
            .url('http://localhost:8080/test/site/www/')
            .call(done);
    })

    it('testaA', function() {
        elem = client.elements('div');
        var title = client.getTitle();
        var url = client.url();

        console.log(title.haha, url.haha);

        return title.should.become('Something');
    });

    it('sdadsa', function(done) {
        elem.then(function(res) {
            console.log(res);
            done();
        })
    })

    after(function(done) {
        client.end(done);
    })
});

// client
//     .init()
//     .url('http://webdriverjs.christian-bromann.com/')
//     .getTitle()
//         .should.become('WebdriverJS Testpage')
//         .should.be.fulfilled
//     .isVisible('body')
//         .should.become(false)
//     .end();


// describe("using promises and chai-as-promised", function() {
//   var browser;

//   before(function() {
//     browser = wd.promiseChainRemote();
//     return browser.init({browserName:'phantomjs'});
//   });

//   beforeEach(function() {
//     return browser.get("http://admc.io/wd/test-pages/guinea-pig.html");
//   });

//   after(function() {
//     return browser.quit();
//   });

//   it("should retrieve the page title", function() {
//     return browser.title().should.become("WD Tests");
//   });

//   it("submit element should be clicked", function() {
//     return browser.elementById("submit").click().eval("window.location.href")
//       .should.eventually.include("&submit");
//   });
// });

// browser = wd.promiseChainRemote();
// browser.init({browserName:'phantomjs'}).then(function(res) {
//     console.log(res);
//     return 'IDIOT!!!!';
// }).then(function(res) {
//     console.log(res);
// });

// client.init().then(function(res) {
//     console.log(res);
//     return "JAJJAAJAJAJJA";
// }).then(function(res) {
//     console.log(res);
// }).end();

// client
//     .init()
//     .url('http://google.de')
//     .getTitle().finally(function(err, res, response) {
//         console.log('err:', err);
//         console.log('res:', res);
//         console.log('response:', response);
//         return this.url();
//     }).finally(function(err, res, response) {
//         console.log('err:', err);
//         console.log('res:', res);
//         console.log('response:', response);
//     })
//     .end()

// client
//     .init()
//     .url('http://google.com').then(function(res) {
//         console.log('execute 1st then');
//         return client.getTitle();
//     }).then(function(title) {
//         console.log(1111, title);
//     })
//     .then(function() {
//         console.log(2222);
//     })
//     .end();


// client
//     .init().then(function(res) {
//         return this.url('http://google.com').getTitle();
//     }).then(function(title) {
//         console.log(2222, 'google', '------------------->', title);
//         return client.url('http://amazon.de').getTitle();
//     }).then(function(title) {
//         console.log(2222, 'amazon', '------------------->', title);
//         return client.url('http://github.com').getTitle();
//     }).then(function(title) {
//         console.log(2222, 'github', '------------------->', title);
//         return client.url('http://npmjs.org').getTitle();
//     }).then(function(title) {
//         console.log(2222, 'npm', '------------------->', title);
//         return client.url('http://bower.io').getTitle();
//     }).then(function(title) {
//         console.log(2222, 'bower', '------------------->', title);
//         return client.url('http://yeoman.de').getTitle();
//     }).then(function(title) {
//         console.log('yeoman', '-------------------->', title);
//     })
//     .end();


// client
//     .init()
//     .url('http://npmjs.org').then(function() {
//         return client.pause(2000).getTitle()
//     }).then(function() {
//         return client.getTitlse();
//     }).pause(10000).then(function(test) {
//         console.log('------>',test);
//         return client.getSource();
//     })
//     .end()


// client.on('error', function() {
//     console.log('heee');
// })

// describe('test', function() {

//     it('testets', function(done) {

//         client
//             .init()
//             .url('http://bromi.de')
//             .getTitle(function(err, title) {
//                 console.log(title);
//             })
//             .click('#maaaa', function(){})
//             .pause(2000)
//             .end(done);
//     });

// });

// // debug = function(query) {
// //     return client.getHTML(query).then(console.log);
// // }

// // debug('h1').end();

// String.prototype.innerHtml = function() {
//     var elem = Array.prototype.slice.call(this).join('');
//     // return function() {
//         // console.log('check html of', elem);
//         return client.getHTML(elem, false).then(console.log);
//     // }()
// }

// "h1".innerHtml().should.eventually.deep.equal('Christian ABromann');


// ".username".value('userA');
// ".password".value('*******');
// "=Hello Jungs".click();
// "h1".innerHtml().should.be.deep.equal('Welcome userA');

// client.end();

// client.addCommand('testa', function(test, done) {
//     console.log('i am here', arguments.length);
//     this.url('http://google.com').getTitle(function(title) {
//         done(title);
//     });
// });

// client
//     .init()
//     .url('http://google.com')
//     .getTitle(function(err, title) {
//         console.log(title);
//     })
//     .testa('hii', function(err, title) {
//         console.log(title);
//     })
//     .end();


